package org.rs.utils.test;

import java.security.KeyPair;
import java.security.interfaces.RSAPrivateKey;
import java.security.interfaces.RSAPublicKey;
import org.apache.commons.codec.binary.Base64;
import org.junit.Test;
import org.rs.utils.RsaUtils;

public class RsaTest {

	//X.509
	static String publicKey = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvxhqLKomPUbhAAA2tw1XEEWmQW/i+xHOvVtctNE6e3jhKgqOf7x8ZfzjLzPbU+gzuC8425gzwLAD3FK9mVo3iMgHhmYUabE5sAnkUngjqBgv5NKSAfsIU50AiyZOsQgPEymlsowjAJmL1HqorGFSDy3z5p+bqsWkLm7lm25hEgOT6Sctf8lxky8wjX115NqhbBEP/jpKATHRrBt/8oH8XXpHebee9x8/v4tu/fk5MtXcu5sG4NcfupkaodfchPqUafPWYk6gONEjJSe2qub93KzF+JtEJ9y2aSNROhAA+6+v0uh9vADnIfb6vkLvOs/76NgJ6kjpb8wtSl8+Z+ZwywIDAQAB";
	//static String publicKey = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAkktkEuFMO95knjn+ivF0x30RhF9+kMOMudySdqC1dAeK1Kp0e/9gFycG4N6PBCCfZJFIMkBVek4fmoFDzwUX8EIih9+NdDQAi39He7KZZVSscMuYzv73IljL9LirbTYRArroiVX/7JOoxIDGQBSvEkuI9glWONXx3WAyzbWiRdU3hA20oj6sGIhMIQvLvm98Rcf9XOr+HOgTQfLarLKiEZ33yseMU2x7tjZDEiLPgQszHbOSOH9HFm1pkvkPXr5D69rzXhyd8QOryiLO/vJhRXxDdzOKIZ8t1Swsq0h8S/HFsl6Infmb+0CvWwQ+pUWN/3h5KYt5TG5HgG+M2I7PbQIDAQAB";
	//PKCS#8
	static String privateKey= "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC/GGosqiY9RuEAADa3DVcQRaZBb+L7Ec69W1y00Tp7eOEqCo5/vHxl/OMvM9tT6DO4LzjbmDPAsAPcUr2ZWjeIyAeGZhRpsTmwCeRSeCOoGC/k0pIB+whTnQCLJk6xCA8TKaWyjCMAmYvUeqisYVIPLfPmn5uqxaQubuWbbmESA5PpJy1/yXGTLzCNfXXk2qFsEQ/+OkoBMdGsG3/ygfxdekd5t573Hz+/i279+Tky1dy7mwbg1x+6mRqh19yE+pRp89ZiTqA40SMlJ7aq5v3crMX4m0Qn3LZpI1E6EAD7r6/S6H28AOch9vq+Qu86z/vo2AnqSOlvzC1KXz5n5nDLAgMBAAECggEAHIYx7wnU3Ge0lTHy+N76ZHjpCLKBUJXHZNd63piuoJiaD5L001dYwEZ/yN92OS+bbL5Lv+eXrgb4BI6rM3VWfcnR6btaB67HHCJV3QOG2wQFPiQ6XCZTB1wTpTGqJF2+Fk+sppqpbOD+kNBgVh7Ox2pGEmI3s8V9rNqr1kgjIDN7e4v67TP2O1bkrj1uLn+RvS2V6/JdfBXD15Y2VYEXKzbOtaSSFIlBe7h6tKWyBH0JZc+5uVUdy/De+JSbQ9wXqqzXy+iFan6Mm2Syhfk7RVlpdHDtD6jini9EU2sbeIVWPqW0xgVN+nilm8QdO8o9ov/SG2EZUqpupar1AOJKOQKBgQDfQ/nEfABivq8WiaDiA24ZY9y+miN0uI2ErSwiIKS+agugoNiTmkFAEGABHFUSHTqL5n4JizKBIe//z+TetR3qwcyBoPHc4BO10bL2aid4vQnOZyqt1gsX3BcCu1TS3Du40iUQkjTRXZTYYlSgy2y4QO0kffv90W4cWZW0nPL+gwKBgQDbHPfAQg7QRyGXUp1oRYBchPHBByD2YEDBTwLkCSy9S5VvvHURAzPpY4P5fZy0BtvkJIvrePnB77HjB1hqBbwllkr8wT/Wb8hnAfUPhymn4yDwAlLb41ww4x8b4QY8fIP/5qJ+nLeU3RVxfzovFkGWIojMWQV/2NX3FTLuHdIyGQKBgQDNUogqKBd6t/3w7hTkhV8FPo9NQheFSgvrjg5ePEMFUiTrTcCezWdgcS65FsMta2/iJNCYGkkR9JHwYdIK9elTcXKPa+HBzNiThwvcDXfLU53nEX1wbL267Y7D1l+Foz/REoE/ohWszTELZjKJxUpwkFUGEE5j9+wZalGAzi2x3QKBgExIKXilhsK8ANXNzT8f8zBCmGe7M56So/ioqTj6eLjuN3hPA/KISupV2vxg3s1OFf+3OX8g/tKlwChpxj4jAP2U9UZJgRAGmp5B8C8Xv0jTqgPkyzQCU3YxnAL4tFMahlnw0WGC7ebFkVGSGY+LEApUu4to8qEvvE3o83Iyr5sBAoGBANeDp1B81Y+dDKlEB6immNJmJgvIOXBdiiPAbwW8AWEeYMyRlwto1vFNBXqhFVCRoec9MQ7eSfMastZKLbGM2HT7/DuryzRCKWvvQA9rXa/aHHIPC03r1NyHJAPca9MfSRxU6eSs0DkmHn6j62WREYpkPgp6rx0M403JuRQ+rsVW";
	//static String privateKey = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCSS2QS4Uw73mSeOf6K8XTHfRGEX36Qw4y53JJ2oLV0B4rUqnR7/2AXJwbg3o8EIJ9kkUgyQFV6Th+agUPPBRfwQiKH3410NACLf0d7spllVKxwy5jO/vciWMv0uKttNhECuuiJVf/sk6jEgMZAFK8SS4j2CVY41fHdYDLNtaJF1TeEDbSiPqwYiEwhC8u+b3xFx/1c6v4c6BNB8tqssqIRnffKx4xTbHu2NkMSIs+BCzMds5I4f0cWbWmS+Q9evkPr2vNeHJ3xA6vKIs7+8mFFfEN3M4ohny3VLCyrSHxL8cWyXoid+Zv7QK9bBD6lRY3/eHkpi3lMbkeAb4zYjs9tAgMBAAECggEAe/KQOUbVdiv4h+6O8V2eGZ6nhsX5z+E+jAKLvSJwWnxBbel1g9FcsoEIXOFzvoV9RpGo35qOUW97a0Z2EyI3pAIEi6YmjPu6MnaGNBGf0bCp4W8+arKu5FTjiNYluAQE6ZE+j41jpid85/BLB+P+aLvCsOI8QS9TGsL0iEGJ2St7d9NE9hET8po2eVFP646/Xo3DRCiWuQBuX4JcTuizHGg2Yhvefz9HwFNK10L+aOw2f87piF2mL3QzWrSacFLxQ9FUoRtPvbhpiKo57loh3t994xQ5b+oqj//rIj2ro5nIuXtL+HRsGMgzSEtMTF6J3KjxfsHon33Rjl30VVMrgQKBgQDwtO0pkpxQHJTblabvxArICCZajWcLMKcTQUcwDFb2GIMPntSBZJVlnt94d9v6czmz/4IzEmbjRFYUq97Rf2p4wZonQoz+i2UcfGs7x+alhCQMSrwJedyE7psZrjjNy8SbF0nalLyUZfeJnDlmSKMIVVsGXBhIcFPE9X0eptx4/QKBgQCbltuV7SXZb6K7uYbz1nmRE0+6PcU88z9MCdnpAlptRmg2GvQ/cznKnrAZh/JAGZAaxEhTVxSbWAhAclRDeXLJdwOwNAPgO81GvUN0FSPo2/o95KKsJlGzk+PMhYlChJ1Fz5NGstPVwc2KeOB0y8n8jafVx/ddvZ4BIr5pfqpzMQKBgQCSWQ6Q5ijPtHD1CQoUYRdFA19+UtbBwPT0Cg5kMjx1J/YXezQs76C9xliMgCNpJMGCpOjecGPJ7fSAYPb6XQO5I8y77gSXht0U8rioAiRDohHgv1eQU102HXSDqp+y0B9bRE+M7D2z5EMakbd8btFg8bSEK15APLtR1wgZqM4HaQKBgFARXENVXQr+diJhIV/OWZUc+QSA0UXCcCpzT16nxV1CxFJDoLoeU/k/nKQm37W48f20UPwCbipbLTPtIgvvLfEbfBxrSCtW2xayQ0ozrt0ghzDevhAVUCo3yxzvA2nl0QGiBsp1MKpqJ5pBBlFUpkd/poVPeK8W637uIEst0g2hAoGAaL/B39eLw/guwQG7n8N+StrabjLeP8DrNqqpFQpcOVO4UdTfROCznYS+rqwAnOzye94Ea7PbuUgu5/F7NIXH8lASiOJWbifx4zWEC4ds5V5l06OIin6oVSf6VIr745a6Yqu2NbcrdsZjYjGOUzuyVPD2SrW3JMsFGq/7NLqhq7c=";
	@Test
	public void test() throws Exception {
		
		KeyPair keyPair = RsaUtils.generateKeyPair(2048);
		System.out.println(Base64.encodeBase64String(keyPair.getPublic().getEncoded()));
		System.out.println(Base64.encodeBase64String(keyPair.getPrivate().getEncoded()));
		
		RSAPublicKey rsaPublicKey = RsaUtils.generateRSAPublicKey(publicKey);
		RSAPrivateKey rsaPrivateKey = RsaUtils.generateRSAPrivateKey(privateKey);
		
		StringBuffer sb = new StringBuffer();
		for( int i = 0; i < 256; i ++ ) {
			sb.append("1");
		}
		sb.append("中国");
		byte[] cryptBytes = RsaUtils.encrypt(rsaPublicKey, sb.toString().getBytes("UTF-8"));
		System.out.println(Base64.encodeBase64String(cryptBytes));
		
		System.out.println(new String(RsaUtils.decrypt(rsaPrivateKey, cryptBytes)));		
		
		String encryptStr = "ceVkYPlJotGoCz6w29p1Mp90hoQ1Ne+srcXLL2m6AX9NJCGAacIiwYx81gKX8v+is8ifxRaj5w9f5rdeTAq07MlqBvGArrL1GsblIGxOEvHZg9X5/jUvhqzlAkXivpSytr5i2Hy2wnwDnyraVfepN9J9oEFVKqk+YJvglVsyNP01g9NGf2AmmjdAaSKHVASnVZs5+/jDdwgZb+nKG6ueBSs8cBAJSrzQEQdLx2urb6G5yRFje0NdN7nSOZ5kvz2JIH6e8Sr2fgh90bm/wETgn/OMuQ8SBRpVZXn5IxWVvc1FqVdQMTd87OnD24hX62p/IpxxbNE6V7BwyTSlg/iZDA==";
		byte[] rowBytes = RsaUtils.decrypt(rsaPrivateKey, Base64.decodeBase64(encryptStr.getBytes("UTF-8")));
		System.out.println(new String(rowBytes,"UTF-8"));
		
	}
}
